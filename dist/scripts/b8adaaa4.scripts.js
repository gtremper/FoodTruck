"use strict";angular.module("FoodTruckApp",["google-maps","ui.bootstrap"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/home.html"}).when("/map",{templateUrl:"views/map.html",controller:"MapCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("FoodTruckApp").controller("MapCtrl",["$scope","$window","foodtruck",function(a,b,c){function d(){var b=a.numTrucks;"number"==typeof b&&0===b%1&&c.getNearbyTrucks(a.clickedLongitude,a.clickedLatitude,b)}google.maps.visualRefresh=!0,a.foodtruck=c,a.mapCenter={latitude:37.76121562849642,longitude:-122.43473052978516},a.mapZoom=12,a.clickedLatitude=null,a.clickedLongitude=null,a.numTrucks=20,a.$watch("clickedLongitude + clickedLatitude + numTrucks",d),a.getCurrentLocation=function(){return b.navigator?(b.navigator.geolocation.getCurrentPosition(function(b){a.clickedLongitude=b.coords.longitude,a.clickedLatitude=b.coords.latitude}),void 0):(alert("Sorry, your browser doesn't support geolocation"),void 0)}}]),angular.module("FoodTruckApp").factory("foodtruck",["$http",function(a){var b={};return b.currentTrucks=[],b.getNearbyTrucks=function(c,d,e){if(!c||!d)return console.log("derp"),void 0;var f={longitude:c,latitude:d,number:e};a.get("/api/findFoodtrucks",{params:f}).success(function(a){b.currentTrucks=[];var c=65;angular.forEach(a,function(a,d){var e;if(d>25){var f=Math.floor(d/26)-1,g=d%26;e=String.fromCharCode(c+f)+String.fromCharCode(c+g)}else e=String.fromCharCode(c+d);var h={name:a.name,longitude:a.location[0],latitude:a.location[1],foods:a.foods,icon:"http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld="+e+"|00FF00|000000"};b.currentTrucks.push(h)})}).error(function(){console.log("ERROR GETTING TRUCKS")})},b}]);